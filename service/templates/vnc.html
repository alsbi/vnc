<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="include/util.js"></script>
</head>

<div align="center">
    <canvas id="noVNC_canvas" width="100%" height=100%">
        Canvas not supported.
    </canvas>
</div>

<script>
    /*jslint white: false */
    /*global window, $, Util, RFB, */
    "use strict";

    // Load supporting scripts
    Util.load_scripts(["webutil.js", "base64.js", "websock.js", "des.js",
        "keysymdef.js", "keyboard.js", "input.js", "display.js",
        "inflator.js", "rfb.js", "keysym.js"]);

    var rfb;

    function sendCtrlAltDel() {
        rfb.sendCtrlAltDel();
        return false;
    }


    window.onscriptsload = function () {
        var token;

        // If a token variable is passed in, set the parameter in a cookie.
        // This is used by nova-novncproxy.
        token = WebUtil.getQueryVar('token', null);
        if (token) {
            WebUtil.createCookie('token', token, 1)
        }


        try {
            rfb = new RFB({
                'target': $D('noVNC_canvas'),
                'encrypt': WebUtil.getQueryVar('encrypt',
                        (window.location.protocol === "https:")),
                'repeaterID': WebUtil.getQueryVar('repeaterID', ''),
                'true_color': WebUtil.getQueryVar('true_color', true),
                'local_cursor': WebUtil.getQueryVar('cursor', true),
                'shared': WebUtil.getQueryVar('shared', true),
                'view_only': WebUtil.getQueryVar('view_only', false),
             });
        } catch (exc) {
            return; // don't continue trying to connect
        }

        rfb.connect('{{host}}', '{{port}}', '{{password}}', '');
    };
</script>

</body>
</html>
